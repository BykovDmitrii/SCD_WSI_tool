# SCD_WSI_tool

Данный инструмент разработан для визуализации и исследования результатов решения задач Word Sense Induction и Lexical Semantic Change Detection.

### Список необходимых библиотек:
* flask - 1.1.1
* fire - 0.3.1
* regex - 2020.5.14
* pymorphy2 - 0.8
* pytorch - 1.4.0
* spacy - 2.1.3 
* pandas - 1.0.1
* numpy - 1.18.1
* scipy - 1.1.0
* scikit-learn - 0.21.1 
* joblib - 0.14.1
* matplotlib - 3.2.0
* seaborn - 0.10.0

использовалась платформа anaconda версии 4.8.3

### Подстановки
Сгенерированные файлы с одстановками можно найти здесь
https://doi.org/10.5281/zenodo.3889976
Каждый из архивов с подстановками рекомендуется распаковывать в отдельную директорию. При запуске системы необходимо будет передать ей путь до этой директории в качестве параметра.

### Запуск
Для запуска приложение необходимо запустить команду, аналогичную

`python web/app.py --data_name=<data_name> --subst1_path=<subst1_path>`

и передать на вход необходимый набор параметров

#### Обязательные параметры
* data_name - имя набора данных, для которого необходимо запустить анализ. По имени датасета система загружает данные, в том числе список целевых слов и данные разметки
* subst1_path - путь до файла с подстановками (.npz) для первого корпуса (в случае, если рассматривается задача wsi - это же и единственный корпус). В случае, если необходимо применить комбинацию шаблонов (например, <mask><mask>-или-T + T-или-<mask><mask>, после имени файла ставится постфикс `+0.0+`

#### Опциональные параметры
* vectorizer_name - string - имя для векторизатора, применяемого для получения векторов подстановок. Возможные варианты - `count` и `tfidf`
* min_df - int/float - параметр векторизатора - минимальная document frequency по наборам подстановок для включения подстановки в словарь векторизатора. Дробные значения (меньше 1) означают относительные значения (доли), целые значения (>=1) - абсолютные значения.
* mad_df - int/float - аналогично min_df - максимальная document frequency по наборам подстановок для включения подстановки в словарь 
* number_of_clusters - int - количество кластеров. При использовании silhouette score для выбора числа кластеров параметр игнорируется. 
* use_silhouette - bool - использовать solhouette score для выбора числа кластеров
* k - int / float - параметр для scd (в режиме wsi игнорируется) - для решающего кластера, приемлимый уровень шума (максимальное количество примеров из другого корпуса) для признания кластера решающим.
* n - int / float - параметр для scd (в режиме wsi игнорируется) - для решающего кластера, необходимое количество примеров из корпуса в кластере для признания его решающим для этого корпуса.
* topk - int - ограничение на количество используемых подстановок
* lemmatizing_method - string - способ лемматизации. Допустимые значения:
  * none - лемматизация не применяется
  * single - подстановка заменяется единственным вариантом своей лемматизации (если вариантов несколько - выбирается случайный). Применимо только для русского, английского и немецкого языков
  * all - подстановка заменяется всеми вариантами своей лемматизации (без повторов). Применимо только для русского языка.
 
 
Открыть приложение можно, введя в строку браузера адрес `http://127.0.0.1:5000/` (при использовании параметров по умолчанию)
 
### Запуск скриптов со стандартными параметрами

Мы подготовили готовые скрипты для запуска системы для определенных корпусов с рекомендованными параметрами.

#### run_web_russe.sh
`run_web_russe.sh <bts-rnc_substitutes_path> [<host>] [<port>]`
На вход скрипту (в виде единственного аргумента) подается путь до папки с подстановками для датасета bts-rnc. Опционально можно передать host-адрес и номер порта, на которых необходимо запустить веб-приложение. 

#### run_web_rumacro.sh
`run_web_russe.sh <rumacro1_substitutes_path> <rumacro2_substitutes_path> [<host>] [<port>]`
Интерфейс данного скрипта аналогичен предыдущему с той разницей, что в данном случае первыми параметрами передаются пути до директорий с файлами подстановок для двух корпусов, входящих в состав датасета RuMacro.

#### run_web_english.sh
`run_web_russe.sh <english1_substitutes_path> <english2_substitutes_path> [<host>] [<port>]`
Интерфейс данного скрипта аналогичен предыдущему.
